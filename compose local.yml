name: imsproject

networks:
  ims-network:
    name: ims-network
    driver: bridge

services:

  ims-game-server:
    build:
      context: game_server
      dockerfile: Dockerfile
    container_name: ims-game-server
    networks:
      - ims-network
    ports:
        - "8080:8080"
        - "8641:8641/udp"
    volumes:
        - /home/admin/volumes/game_server:/app/data
    extra_hosts:
      - "host.docker.internal:host-gateway"

  ims-manager:
    build:
      context: manager
      dockerfile: Dockerfile
    container_name: ims-manager
    networks:
      - ims-network
    ports:
      - "5000:5000"
    volumes:
      - /home/admin/volumes/manager:/app/data

  ims-db:
    image: postgres:latest
    container_name: ims-db
    environment:
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: adminMTAC
      POSTGRES_DB: ims-db
    ports:
      - "5432:5432"
    networks:
      - ims-network
    volumes:
      - ./database/init.sql:/docker-entrypoint-initdb.d/init.sql
      - ./database/data:/var/lib/postgresql/data
